<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="css/styles.css">
    <link href="css/fonts.css" rel="stylesheet">
    <script src="js/d3.v4.min.js"></script>
    <title>Herd Immunity Visualization</title>
</head>

<body>
    <div id="container">
        <h1>Herd Immunity</h1>
        <div class="block">
            <h3>What is Herd Immunity?</h3>
            <p>
                Herd immunity is a concept describing the group protection from an infectious disease that emerges when critical mass of
                the population is immunized from receiving and spreading that disease. In most cases immunization comes from
                vaccination against the specific disease. These immunized people in the population prevent the disease from
                being passed further along to people they pass by. In other words, persons that are not immune to disease
                can still be shielded against contracting it by virtue of others in the population being unable to pass it
                on. The greater number of people immune to a disease, the less likely of a chance that someone vulnerable
                to the disease will contract it. Herd immunity is important because there people who cannot be vaccinated
                against certain diseases such as those who are too young, too old, or allergic to the vaccination. These
                people must rely on those around to get vaccinated so that the diease has lower odds of spreading to them.
            </p>
            <img class="diagram" src="images/diagram.png" alt="image illustrating spread of a virus">
            <p class="caption">The diagram above shows the difference between how a disease might spread in a population where no one is protected
                against the disease versus where the population where some people are vaccinated. Notice that some of the
                people who are not vaccinated remain uninfected because immune neighbors impeded the spread of the disease.</p>
        </div>

        <div class="block">
            <div class="flex-container">
                <div class="flex-item">
                    <h3>Calculating Herd Immunity</h3>
                    <p>
                        A population is deemed to have achieved herd immunity against an infectious disease outbreak when they have reached or surpassed
                        the herd immunity threshold, denoted as Q<sub>c</sub>. To calculate the value of Q
                        <sub>c</sub>, one would need to know the basic reproductive rate of the specific disease, denoted as R
                        <sub>0</sub>. R<sub>0</sub> is a numeric measure representing the average number of infections made by that specific
                        disease based on it's various attibutes such as method of spread and duration if infection. The higher
                        that number is, the more infectious the disease is said to be. Using the entire equation, we can determine
                        the herd immunity threshold calculated by solving for the equation <b>Q<sub>c</sub> = 1 – &#40;1/R<sub>0</sub>&#41;</b>.
                        For example, mumps can have a R<sub>0</sub> of 7, so we can subsitute it in giving us 1 - (1/7) = 0.86, which, when converted int o percentage, yields a herd immunity threshold of
                        approximately 86%.
                    </p>

                    <p>
                        One additional step required to determine the vaccination rate needed for the population. This equation makes the assumption that vaccination against the disease would be 100 percent effective.
                        In reality, vaccines are not perfectly effective. Therefore to calculate the vaccination rate needed for herd immunity,
                        we also need to divide Q<sub>c</sub> by the effectiveness of the vaccine denoted as &#40;<i>E</i>&#41;. Thus the percentage of the population required need to vaccinated to reach the herd immunity
                        threshold can be approximated as<b>V<sub>c</sub> = Q<sub>c</sub>/<i>E</i></b>. Going with the previous mumps example, two doses of the mumps vaccine result a effectiveness of 88%. When converted to a decimal,
                        we can get the equation 0.86/0.88 = 0.97, which converts to 97%. So 97% of the population is actually needed to achieve herd immunity against mumps!
                    </p>
                    <p>
                        When the vaccination coverage of a population has the necessary percentage for herd immunity, the disease is thought off
                        as "contained".
                    </p>
                </div>
                <div class="flex-item" style="margin-left: 100px;">
                    <h3 style="text-align: center;">Reproductive Numbers for some well known diseases</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Disease Name</th>
                                <th>Reproductive Number &#40;R
                                    <sub>0</sub>&#41;</th>
                                <th>Vaccine Effectiveness &#40;
                                    <i>E</i>&#41;</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Measles</td>
                                <td>12-18</td>
                                <td>93% &#40;One Dose&#41;
                                    <br> 97% &#40;Two Doses&#41;</td>
                            </tr>
                            <tr>
                                <td>Mumps</td>
                                <td>4-7</td>
                                <td>78% &#40;Two Doses&#41;
                                    <br>88% &#40;Three Doses&#41;</td>
                            </tr>
                            <tr>
                                <td>Polio</td>
                                <td>5-7</td>
                                <td>90% &#40;Two Doses&#41;
                                    <br>99% &#40;Three Doses&#41;</td>
                            </tr>
                            <tr>
                                <td>Rubella</td>
                                <td>5-7</td>
                                <td>97%</td>
                            </tr>
                            <tr>
                                <td>Seasonal Flu</td>
                                <td>1-2</td>
                                <td>Varys, but typically
                                    <br>between 40% - 60%</td>
                            </tr>
                        </tbody>
                    </table>
                    <p class="citation">
                        History and epidemiology of global smallpox eradication. (2014, August 25).
                        <i> Retrieved from https://stacks.cdc.gov/view/cdc/27929</i>
                    </p>
                    <p class="citation">
                        Vaccine Effectiveness - How Well Does the Flu Vaccine Work? (n.d.).
                        <i> Retrieved from https://www.cdc.gov/flu/about/qa/vaccineeffect.htm</i>
                    </p>
                    <p class="citation">
                        Measles, Mumps, and Rubella (MMR) Vaccination: What Everyone Should Know. (n.d.)
                        <i>Retrieved from https://www.cdc.gov/vaccines/vpd/mmr/public/index.html</i>
                    </p>
                    <p class="citation">
                        Polio Vaccine Effectiveness and Duration of Protection (n.d.)
                        <i>https://www.cdc.gov/vaccines/vpd/polio/hcp/effectiveness-duration-protection.html</i>
                    </p>
                </div>
            </div>
        </div>
        <div class="block">
            <h1>Your Turn - Simulate your own Outbreak</h1>
            <p>

                Watch the effect of vaccination and herd immunity in action by simulating your own outbreak. In the simulation you will be
                able to modify the reproductive rate of your disease, the effectiveness of the vaccination against it and
                the vaccination rate of the population. In the simulation, your fictitious disease will have ten attempts
                infect someone in a population of 250 people. Each time the disease infects a person, it will spread twice
                according to the reproductive rate you set – once to the R0 number of closest neighbors from the initial
                infection, and then again for each of the neighbors infected. To incorporate some real life randomness, the
                location distribution of the vaccinated, unvaccinated and vaccinated but vulnerable is randomly distributed. This will cause some variation the
                simulation, but you view see the average results on the line graph.

            </p>
            <div class="flex-container" id="sim-settings">
                <div class="flex-item">
                    <div class="formulas">
                        <h4>Threshold Percentage</h4>
                        <span class="thresholdNumber">Qc</span> = 1 - &#40; 1&#x2F;
                        <span id="rZero_formula">R
                            <sub>0</sub>
                        </span>&#41;
                        <h4>Vaccination Rate needed with Vaccine Effectiveness Factored in</h4>
                        <span id="threshold-number-percent"></span>
                        <span id="populationNeeded">Vc</span> =
                        <span class="thresholdNumber">Qc</span>&#x2F;
                        <span id="effect-formula">E</span>
                        <br>
                        <div id="message"> </div>
                    </div>
                    <form id="config" oninput="handleFormChange()">
                        <div class="form-block">
                            <h4 class="form-header">Virus Characteristic</h4>
                            <p class="form-short-label">Set how Aggressively the disease can spread.</p>
                            <label class="form-label" for="r-number">Reproductive Rate (Number between 1-20) </label>
                            <br>
                            <input name="rZero" type="range" value="10" id="r-number" min="1" max="20">
                            <span id="rZero-view">10</span>
                        </div>

                        <div class="form-block">
                            <h4 class="form-header">Vaccine Characteristic</h4>
                            <p class="form-short-label">Set how effect the vaccine against the disease will be. </p>
                            <label class="form-label" for="effect">Vaccine Effectiveness</label>
                            <br>
                            <input name="vaccineEffect" type="range" value="50" id="effect" min="1" max="100">
                            <span id="effect-view">50%</span>
                        </div>

                        <div class="form-block">
                            <h4 class="form-header">Simulation Population Vaccination Rate</h4>
                            <p class="form-short-label">How much of the population will be vaccinated in the simulation?</p>
                            <label class="form-label" for="safe-percent">Percent Vaccinated</label>
                            <br>
                            <input name="percentVaccinate" type="range" value="50" id="safe-percent" min="1" max="100">
                            <span id="safe-percent-view">50%</span>
                        </div>
                    </form>
                    <button id="start-sim" onclick="main()">Start Simulation</button>
                </div>
                <div class="flex-item">
                    <div id="probability-graph"></div>
                </div>
            </div>
        </div>
        <div>
            <svg id="icons" display="block" width="1000" height="50">
                <circle r="7.5" fill="black" cx="10" cy="10"></circle>
                <text x="25" y="15" font-family="Open sans" text-anchor="start" font-size="16">Unvaccinated</text>

                <circle r="7.5" fill="#F6E481" cx="150" cy="10"></circle>
                <text x="165" y="15" font-family="Open sans" text-anchor="start" font-size="16">Vaccinated, but Vulnerable</text>

                <circle r="7.5" fill="green" cx="380" cy="10"></circle>
                <text x="395" y="15" font-family="Open sans" text-anchor="start" font-size="16">Vaccinated and Immune</text>

                <circle r="7.5" fill="red" cx="600" cy="10"></circle>
                <text x="615" y="15" font-family="Open sans" text-anchor="start" font-size="16">Infected</text>
            </svg>
            <hr>
        </div>
        <div class="block flex-container" id="sim-area">
            <div class="flex-item">
                <svg id="graph" width="500" height="500">
                    <text x="250" y="50" font-family="Open Sans" text-anchor="middle" font-size="20">
                        Press Simulate to Begin Outbreak
                    </text>
                    <image href="images/placeholder.png" x=50 y="75"></image>
                </svg>
            </div>
            <div class="flex-item">
                <h3>Current Simulation Population Distribution</h3>
                <p>Hover to learn more about a segment</p>
                <svg id="donut" width="500" height="250"></svg>
                <div>
                    <p id="sim-comment" class="hidden">
                        Javascript is broken :&#40;
                    </p>
                </div>
                <div class="page-jump">
                    <a href="#sim-settings">Back to Settings</a>
                </div>
            </div>
        </div>
        <div id="final-stats">
            <h1>Simulation Log</h1>
            <table>
                <thead>
                    <tr>
                        <th>Sim No. </th>
                        <th>Reproductive Number</th>
                        <th>Percent Vaccinated</th>
                        <th>Percent of Possible</th>
                        <th>Percent of Total</th>
                    </tr>
                </thead>
                <tbody id="final-stats-body">

                </tbody>
            </table>
        </div>
        <div class="block" style="padding-top: 50px">
            <h1>References</h1>
            <p class="citation">The Simple Math of Herd Immunity. (2015, April 20).
                <i>Retrieved from https://thoughtscapism.com/2015/04/20/the-simple-math-of-herd-immunity/</i>
            </p>
            <p class="citation">
                What is Herd Immunity? (2014, September 5).
                <i> Retrieved from http://www.pbs.org/wgbh/nova/body/herd-immunity.html</i>
            </p>
        </div>
    </div>
    <script src="js/main.js"></script>
    <script src="js/probability.js"></script>
    <script src="js/donut.js"></script>
    <script src="js/lineChart.js"></script>
</body>
</html>
